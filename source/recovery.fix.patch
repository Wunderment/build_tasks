diff --git a/sepolicy/private/file.te b/sepolicy/private/file.te
index 10f4d41..ad1cdde 100644
--- a/sepolicy/private/file.te
+++ b/sepolicy/private/file.te
@@ -17,3 +17,27 @@ type sysfs_usb_supply, sysfs_type, fs_type;
 
 # data
 type display_misc_file, file_type, data_file_type, core_data_file_type;
+
+#recvoery fix
+type opbrightness_exec, exec_type, file_type, system_file_type;
+type xbl_block_device, dev_type;
+type custom_ab_block_device, dev_type;
+type ab_block_device, dev_type;
+type modem_block_device, dev_type;
+type mdtp_device, dev_type;
+type gpt_block_device , dev_type;
+type sg_device, dev_type;
+type ssd_device, dev_type;
+type uefi_block_device, dev_type;
+type logdump_partition, dev_type;
+type modem_efs_partition_device, dev_type;
+type rpmb_device, dev_type;
+type mba_debug_dev, dev_type;
+type dip_device, dev_type;
+type rawdump_block_device, dev_type;
+type persist_block_device, dev_type;
+type init-qti-fbe-sh_exec, exec_type, file_type, vendor_file_type;
+type qti_init_shell_exec, exec_type, vendor_file_type,file_type;
+type sensors_exec, exec_type, vendor_file_type, file_type;
+type sysfs_scsi_target, fs_type, sysfs_type;
+type sysfs_scsi_host, fs_type, sysfs_type;
diff --git a/sepolicy/private/file_contexts b/sepolicy/private/file_contexts
index 302b3f6..18cc80f 100644
--- a/sepolicy/private/file_contexts
+++ b/sepolicy/private/file_contexts
@@ -28,3 +28,101 @@
 /(product|system/product)/vendor_overlay/[0-9]+/etc(/.*)?        u:object_r:vendor_configs_file:s0
 /(product|system/product)/vendor_overlay/[0-9]+/lib(64)?/hw      u:object_r:vendor_hal_file:s0
 /(product|system/product)/vendor_overlay/[0-9]+/overlay(/.*)?    u:object_r:vendor_overlay_file:s0
+
+# Thermal sensor for recovery
+/sys/class/thermal(/.)?                         u:object_r:sysfs_thermal:s0
+/sys/devices/[^/]+bcl[^/]+(/.)?                 u:object_r:sysfs_thermal:s0
+/sys/module/msm_thermal(/.)?                    u:object_r:sysfs_thermal:s0
+/sys/devices/virtual/thermal(/.)?               u:object_r:sysfs_thermal:s0
+/sys/devices/platform/battery_current_limit     u:object_r:sysfs_thermal:s0
+
+/sys/devices(/platform)?/soc/[a-f0-9]+.ufshc/clkscale_enable		u:object_r:sysfs_scsi_host:s0
+/sys/devices(/platform)?/soc/[a-f0-9]+/host0/scsi_host/host0(/.*)?		u:object_r:sysfs_scsi_host:s0
+/sys/devices(/platform)?/soc/[a-f0-9]+.ufshc/host0/target0:0:0/0:0:0:[0-9]+/scsi_generic(/.*)?		u:object_r:sysfs_scsi_target:s0
+
+/sys/class/leds/led:torch_[0-9]/brightness		u:object_r:sysfs_oem:s0
+/sys/devices/platform/soc/[a-f0-9]+.qcom,mdss_mdp/drm/card([0-3])+/card([0-3])+-DSI-1/hbm_brightness		u:object_r:sysfs_graphics:s0
+/sys/class/leds/led:switch_[0-9]/brightness		u:object_r:sysfs_oem:s0
+/system/bin/auto_brightness_log.sh		u:object_r:opbrightness_exec:s0
+/sys/devices/platform/soc/c440000.qcom,spmi/spmi-0/spmi0-03/c440000.qcom,spmi:qcom,pmi8998@3:qcom,leds@d300/leds/led:torch_[0-9]/brightness		u:object_r:sysfs_oem:s0
+/sys/devices/platform/soc/c440000.qcom,spmi/spmi-0/spmi0-03/c440000.qcom,spmi:qcom,pmi8998@3:qcom,leds@d300/leds/led:switch_[0-9]/brightness		u:object_r:sysfs_oem:s0
+
+
+
+# UFS Devices
+/dev/block/platform/soc/1d84000.ufshc/by-name/system                            u:object_r:system_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/userdata                          u:object_r:userdata_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/boot                              u:object_r:boot_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/logdump                           u:object_r:logdump_partition:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/fsc                                u:object_r:modem_efs_partition_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/fsg                                u:object_r:modem_efs_partition_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/modemst1                           u:object_r:modem_efs_partition_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/modemst2                           u:object_r:modem_efs_partition_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/ssd                                u:object_r:ssd_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/misc                               u:object_r:misc_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/rpm                                u:object_r:rpmb_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/msadp                              u:object_r:mba_debug_dev:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/recovery                           u:object_r:recovery_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/cache                              u:object_r:cache_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/frp                                u:object_r:frp_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/mdtp                               u:object_r:mdtp_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/dip                                u:object_r:dip_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/storsec                            u:object_r:boot_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/super                              u:object_r:super_block_device:s0
+
+#rawdump partition
+/dev/block/platform/soc/1d84000.ufshc/by-name/rawdump                            u:object_r:rawdump_block_device:s0
+
+# A/B partitions.
+/dev/block/platform/soc/1d84000.ufshc/by-name/abl_[ab]          u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/apdp_[ab]         u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/boot_[ab]         u:object_r:boot_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/cmnlib_[ab]       u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/cmnlib64_[ab]     u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/devcfg_[ab]       u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/hyp_[ab]          u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/keymaster_[ab]    u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/modem_[ab]        u:object_r:modem_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/bluetooth_[ab]    u:object_r:modem_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/msadp_[ab]        u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/pmic_[ab]         u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/rpm_[ab]          u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/system_[ab]       u:object_r:system_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/tz_[ab]           u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/vendor_[ab]       u:object_r:system_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/xbl_[ab]          u:object_r:xbl_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/aop_[ab]          u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/vbmeta_[ab]       u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/dtbo_[ab]         u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/dsp_[ab]          u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/mdtp_[ab]         u:object_r:mdtp_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/mdtpsecapp_[ab]   u:object_r:mdtp_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/qupfw_[ab]        u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/xbl_config_[ab]   u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/storsec_[ab]      u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/ImageFv_[ab]      u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/persist           u:object_r:persist_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/recovery_[ab]     u:object_r:recovery_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/vbmeta_system_[ab]  u:object_r:custom_ab_block_device:s0
+/dev/block/platform/soc/1d84000.ufshc/by-name/uefisecapp_[ab]     u:object_r:uefi_block_device:s0
+
+# Block device holding the GPT, where the A/B attributes are stored.
+/dev/block/platform/soc/1d84000.ufshc/sd[ade]                   u:object_r:gpt_block_device:s0
+
+# Block devices for the drive that holds the xbl_a and xbl_b partitions.
+/dev/block/platform/soc/1d84000.ufshc/sd[bc]                 u:object_r:xbl_block_device:s0
+
+##################################
+# non-hlos mount points
+# FBE
+/(vendor|system/vendor)/bin/init.qti.qseecomd.sh		u:object_r:init-qti-fbe-sh_exec:s0
+
+/vendor/bin/init.qti.chg_policy.sh                  u:object_r:qti_init_shell_exec:s0
+
+# Same process file
+/vendor/lib(64)?/hw/gralloc\.sdm845\.so   u:object_r:same_process_hal_file:s0
+/vendor/lib(64)?/hw/vulkan\.sdm845\.so    u:object_r:same_process_hal_file:s0
+/(vendor|system/vendor)/bin/sscrpcd       u:object_r:sensors_exec:s0
+
+/dev/sg[0-9]+                                   u:object_r:sg_device:s0
+
diff --git a/sepolicy/private/genfs_contexts b/sepolicy/private/genfs_contexts
index 3d4270d..a2e27dc 100644
--- a/sepolicy/private/genfs_contexts
+++ b/sepolicy/private/genfs_contexts
@@ -30,3 +30,9 @@ genfscon sysfs /devices/platform/soc/8300000.qcom,turing/subsys5/restart_level u
 
 genfscon sysfs /devices/platform/soc/4080000.qcom,mss/subsys6/name u:object_r:sysfs_ssr:s0
 genfscon sysfs /devices/platform/soc/4080000.qcom,mss/subsys6/restart_level u:object_r:sysfs_ssr_toggle:s0
+
+# Recovery fix.
+genfscon sysfs /devices/virtual/thermal                                 u:object_r:sysfs_thermal:s0
+genfscon sysfs /class/thermal                                           u:object_r:sysfs_thermal:s0
+genfscon sysfs /module/msm_thermal                                      u:object_r:sysfs_thermal:s0
+genfscon sysfs /devices/platform/battery_current_limit                  u:object_r:sysfs_thermal:s0
